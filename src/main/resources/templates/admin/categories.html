<!DOCTYPE html>
<html lang="pl" xmlns:th="https://www.thymeleaf.org/" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <meta charset="UTF-8">
    <title>Panel administratora - Serwis ogłoszeniowy</title>
    <link rel="stylesheet" href="../../static/style/main.css" th:href="@{../style/main.css}">
</head>
<body>
<header>
    <h1><a th:href="@{/}">Serwis ogłoszeniowy</a></h1>
    <h3>Panel administratora</h3>
    <p sec:authorize="isAuthenticated()" th:text="|Witaj, ${#authentication.getName()}!|"></p>
    <p sec:authorize="isAuthenticated()" th:text="|Twoja rola: ${#authentication.getAuthorities()}|"></p>
    <!--            <form method="post" th:action="@{/logout}">-->
    <!--                <input th:name="${_csrf.parameterName}" th:value="${_csrf.token}" hidden>-->
    <a sec:authorize="isAuthenticated()" th:text="|Wyloguj się|" th:href="@{/logout}" href="#"></a>
    <!--            </form>-->
</header>
<nav class="navigation">
    <a class="category" th:href="@{/admin/bans}" href="#">Blokady kont</a>
    <a class="category" th:href="@{/admin/admins}" href="#">Administratorzy</a>
    <a class="category" th:href="@{/admin/categories}" href="#">Kategorie</a>
</nav>
<a th:href="@{../}">Powróć do strony głównej</a>
<main>
    <p th:if="${error} != null" th:text="${error}" class="error"></p>
    <div>
        <a th:href="@{/admin/add-category}">Dodaj kategorię</a>
    </div>
    <p th:if="${categories == null || categories.isEmpty()}" th:text="|Nie ma w systemie żadnych blokad.|"></p>

    <table class="table" th:unless="${categories == null || categories.isEmpty()}">
        <tr>
            <th>Nazwa kategorii</th>
            <th>Opis</th>
            <th>Edytuj</th>
            <th>Usuń</th>
        </tr>
        <tr th:each="category: ${categories}">
            <td th:text="*{category.name}"></td>
            <td th:text="*{category.description}"></td>
            <td><a th:href="|/admin/edit-category?id=${category.id}|" th:text="Edytuj"></a></td>
            <td><a th:href="|/admin/remove-category?id=${category.id}|" th:text="Usuń"></a></td>
        </tr>
    </table>
</main>
<footer>
    &copy; Mikołaj Diakowski
</footer>
<script type="text/javascript">
    let elementById = document.getElementById("page-dropdown");
    elementById.addEventListener("change", function () {
        let page = elementById.value;
        window.location.href = "/admin/?page=" + page;
        if (new URLSearchParams(window.location.search).get("userid") == null)
            window.location.href+= "&userid=" + page;
    });
</script>
</body>
</html>
